<!DOCTYPE html>
<html>
    <head>
	<meta charset='UTF-8'>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<meta name='description' content='Blog de tecnologia do Elo7, mantido pelo nosso time de Engenharia, compartilhando conhecimento e mostrando como é o dia a dia de um colaborador fora de série.'>
	<meta name='google-site-verification' content='NqCILBTY8B8P-r_KF8BSZKH9kUQgQOEbXJvEMaB33vw'>
	<meta name='google-site-verification' content='cKh-stJM3_ENNfMjaBIIyYiDgMXZFpRkoH8eQTcPwhM' />
	<meta name='theme-color' content='#FDC24F'>
	<meta name='keywords' content='Elo7,tecnologia,post,desenvolvimento,blog,java,mockito,tdd,'>
	<meta name='language' content='pt-br'>
	<meta name='title' content='Elo7 Tech - Testes de código com Mockito (2) - Novidades da nova versão'>
	<meta name='apple-mobile-web-app-title' content='Elo7 Tech - Testes de código com Mockito (2) - Novidades da nova versão'>
	<meta name='mobile-web-app-capable' content='yes'>

	<meta property='fb:app_id' content='644444999041914'>
	<meta property='fb:admins' content='100003324447975'>

	<meta property='og:site_name' content='Elo7 Tech'>
	<meta property='og:image' content='https://elo7.dev/images/cover/testes-de-codigo-com-mockito-parte-2.png'>
	<meta property='og:type' content='website'>
	<meta property='og:title' content='Elo7 Tech - Testes de código com Mockito (2) - Novidades da nova versão'>
	<meta property='og:url' content='https://elo7.dev/testes-codigo-mockito-2/'>
	<meta property='og:description' content='Blog de tecnologia do Elo7, mantido pelo nosso time de Engenharia, compartilhando conhecimento e mostrando como é o dia a dia de um colaborador fora de série.'>

	<meta name='twitter:widgets:csp' content='on'>
	<meta name='twitter:card' content='summary_large_image'>

	<meta property='twitter:title' content='Elo7 Tech - Testes de código com Mockito (2) - Novidades da nova versão'>
	<meta property='twitter:domain' content='https://elo7.dev/'>
	<meta property='twitter:url' content='https://elo7.dev/testes-codigo-mockito-2/'>
	<meta property='twitter:description' content='Blog de tecnologia do Elo7, mantido pelo nosso time de Engenharia, compartilhando conhecimento e mostrando como é o dia a dia de um colaborador fora de série.'>
	<meta property='twitter:image' content='https://elo7.dev/images/ico/elo7.png'>

	<link rel='canonical' href='https://elo7.dev/testes-codigo-mockito-2/'>
	<title>Elo7 Tech - Testes de código com Mockito (2) - Novidades da nova versão</title>
	<link rel='stylesheet' href='https://elo7.dev/css/reset.css'>
	<link rel='stylesheet' href='https://elo7.dev/css/vendor/highlight.css' >
	<link rel='stylesheet' href='https://elo7.dev/css/main.css' >
	<link rel='stylesheet' href='https://elo7.dev/css/posts.css' >
	<link rel='stylesheet' href='https://elo7.dev/css/post.css' >
	<link rel='stylesheet' href='https://elo7.dev/css/publisher.css' >
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-16.png' sizes='16x16'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-32.png' sizes='32x32'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-48.png' sizes='48x48'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-64.png' sizes='64x64'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-96.png' sizes='96x96'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-128.png' sizes='128x128'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-160.png' sizes='160x160'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-192.png' sizes='192x192'>
	<link rel='apple-touch-icon-precomposed' sizes='180x180' href='https://elo7.dev/images/favicon/favicon-180.png'>
	<link rel='apple-touch-icon-precomposed' sizes='152x152' href='https://elo7.dev/images/favicon/favicon-152.png'>
	<link rel='apple-touch-icon-precomposed' sizes='144x144' href='https://elo7.dev/images/favicon/favicon-144.png'>
	<link rel='apple-touch-icon-precomposed' sizes='120x120' href='https://elo7.dev/images/favicon/favicon-120.png'>
	<link rel='apple-touch-icon-precomposed' sizes='114x114' href='https://elo7.dev/images/favicon/favicon-114.png'>
	<link rel='apple-touch-icon-precomposed' sizes='76x76' href='https://elo7.dev/images/favicon/favicon-76.png'>
	<link rel='apple-touch-icon-precomposed' sizes='72x72' href='https://elo7.dev/images/favicon/favicon-72.png'>
	<link rel='apple-touch-icon-precomposed' sizes='60x60' href='https://elo7.dev/images/favicon/favicon-60.png'>
	<link rel='apple-touch-icon-precomposed' sizes='57x57' href='https://elo7.dev/images/favicon/favicon-57.png'>
	<link rel='apple-touch-icon-precomposed' href='https://elo7.dev/images/favicon/favicon-precomposed.png'>
	<script>window.addEventListener('error', window.__e=function f(e){f.q=f.q||[];f.q.push(e)});</script>
	<script src='/js/vendor/async-define.js'></script>
</head>

    <body>
        <header class='left-pane'>
    <div class='logo-container'>
        <a rel='home' itemprop='url' href='https://elo7.dev/' class='logo'>Tech Blog Elo7</a>
    </div>
    <div class='navigation'>
        <input id='categories-switch' type='checkbox' class='categories-switch'>
        <label for='categories-switch' class='selectable'>
            <h2 class='nav-title'>Categorias</h2>
        </label>
        <nav aria-label='Navegue pelas categorias do nosso blog' class='nav-list nav-category'>
            
                <a href='/categoria/back-end' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Back End</a></span>
                </a>
            
                <a href='/categoria/cultura' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Cultura</a></span>
                </a>
            
                <a href='/categoria/data-science' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Data Science</a></span>
                </a>
            
                <a href='/categoria/design' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Design</a></span>
                </a>
            
                <a href='/categoria/devops' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Devops</a></span>
                </a>
            
                <a href='/categoria/eventos' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Eventos</a></span>
                </a>
            
                <a href='/categoria/front-end' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Front End</a></span>
                </a>
            
                <a href='/categoria/mobile' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Mobile</a></span>
                </a>
            
                <a href='/categoria/vagas' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Vagas</a></span>
                </a>
            
            <a href='/talks' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                <span itemprop='name'>Palestras</span>
            </a>
        </nav>
    </div>
    <div class='navigation'>
        <input id='more-switch' type='checkbox' class='more-switch'>
        <label for='more-switch' class='selectable'>
            <h2 class='nav-title'>Veja também</h2>
        </label>
        <nav class='nav-list nav-more' aria-label='Navegue pelos links relacionados ao Elo7'>
            <a itemprop='relatedLink' href='http://carreira.elo7.com.br/engenharia/' target='_blank'>
                <span itemprop='name'>A engenharia</span>
            </a>
            <a itemprop='relatedLink' href='http://carreira.elo7.com.br/' target='_blank'>
                <span itemprop='name'>Carreiras</span>
            </a>
            <a itemprop='relatedLink' href='http://eventos.elo7.com.br/' target='_blank'>
                <span itemprop='name'>Nossos eventos</span>
            </a>
            <a itemprop='relatedLink' href='http://elo7.com.br/' target='_blank'>
                <span itemprop='name'>Elo7</span>
            </a>
        </nav>
    </div>
    <div class='social'>
        <a title='Github do Elo7' rel='external' itemprop='relatedLink' href='https://github.com/elo7' target='_blank' class='github'>Github do Elo7</a>
        <a title='Twitter do Elo7' rel='external' itemprop='relatedLink' href='https://twitter.com/elo7tech' target='_blank' class='twitter'>Twitter do Elo7</a>
        <a title='RSS do Elo7' rel='external' itemprop='relatedLink' href='https://elo7.dev/index.xml' target='_blank' class='rss'>RSS do Elo7</a>
        <a title='Newsletter do Elo7' rel='external' itemprop='relatedLink' href='http://eepurl.com/cVUwvH' target='_blank' class='email'>Newsletter do Elo7</a>
    </div>
</header>

        <main aria-label='Conteúdo principal' itemscope itemtype='http://schema.org/Blog'>
            <article itemprop='blogPost' itemscope itemtype='http://schema.org/BlogPosting' class='post-main'>
                <figure class='cover-image' itemprop="image" itemscope itemtype="http://schema.org/ImageObject">
                    <img src='/images/cover/testes-de-codigo-com-mockito-parte-2.png' alt='Testes de código com Mockito (2) - Novidades da nova versão' itemprop="url">
                </figure>
                <div class='post-content'>
                    <h1 itemprop='name' class='title'>Testes de código com Mockito (2) - Novidades da nova versão</h1>
                    <div class='post-meta'>
                        <p class='date'>
                            Publicado em:
                            <time class='date'
    datetime='2017-08-21 00:00:00 &#43;0000 UTC'
    aria-label='21 de agosto de 2017'>
    21/08/2017
    <meta itemprop='datePublished' content='Mon Aug 21 2017 00:00:00 GMT&#43;0000 (UTC)'/>
    <meta itemprop='dateModified' content='Mon Aug 21 2017 00:00:00 GMT&#43;0000 (UTC)'>
</time>
                        </p>

                        <article>
                            
                                <a data-author='ljtfreitas' itemprop='author' itemscope itemtype='http://schema.org/Person' rel='author' href='/autor/ljtfreitas/' class='author'>
                                    <meta itemprop='url' content='/autor/ljtfreitas'>
                                    <img class='hide avatar' width='50px' height='50px' itemprop='image'>
                                    <p itemprop='name' class='publisher' data-author='ljtfreitas'>@ljtfreitas</p>
                                </a>
                            

                            <meta itemprop='worksFor' content='Elo7 Serviços de Informática SA'>
                        </article>
                    </div>
                    <div itemprop='articleBody'>
                        

<p>Há algum tempo, escrevi um <a href="/testes-codigo-mockito">post</a> sobre o funcionamento e os principais recursos do <a href="http://site.mockito.org/">Mockito</a>. Na ocasião em que o post foi escrito, a versão 2 do framework ainda estava em beta, e, nesse tempo, não apenas foi <a href="https://github.com/mockito/mockito/wiki/What%27s-new-in-Mockito-2">oficialmente lançada</a> como ocorreram vários releases subsequentes (no momento em que escrevo, a última versão é a 2.7.22).</p>

<p>Neste post, vou demonstrar as principais novidades e funcionalidades dessa nova versão.</p>

<h2 id="construção-de-mocks-proxy-de-objetos-e-classes-final">Construção de mocks/proxy de objetos e classes final</h2>

<p>A principal alteração interna da versão 2 do Mockito foi a mudança da biblioteca utilizada para construção de mocks/proxificação de objetos. Para entendermos melhor essa mudança, cabe perguntar: o que raios é um proxy?</p>

<p>Sem me estender muito na explicação, &ldquo;proxy&rdquo; é um design pattern que permite colocar um objeto &ldquo;espelho&rdquo; à frente de outro, que implemente a mesma interface (interface = conjunto de métodos expostos do objeto). Esse objeto &ldquo;espelho&rdquo; (que é a instância efetivamente usada no código, funcionando como um substituto ao objeto real) é capaz de interceptar as chamadas de método realizadas, capturando os metadados do método invocado e os argumentos enviados. O proxy é capaz de realizar tratamentos específicos para algum método em particular, ou manipular os argumentos antes de invocar o método no objeto &ldquo;verdadeiro&rdquo;, e eventualmente até mesmo cancelar a invocação. Normalmente, isso é implementado utilizando algum recurso fornecido pela própria linguagem.</p>

<p>No caso do Java, proxys são um elemento fundamental em frameworks de mock. TODOS os mocks gerados pelo Mockito são proxies da classe que está sendo &ldquo;mockada&rdquo;. No meu primeiro post, eu disse que uma definição fundamental da palavra &ldquo;mock&rdquo; é que se trata de um <strong>objeto gerado em tempo de execução</strong>; em Java, isso ocorre literalmente, porque um proxy é, com efeito, bytecode gerado em tempo de execução :).</p>

<p>A API padrão do Java permite a geração de proxies <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Proxy.html#getProxyClass">apenas para interfaces</a>; essa limitação era contornada com o uso de algumas coisas complicadas como instrumentação de código, manipulação de bytecode e compilação em runtime. As bibliotecas que se destacam na comunidade Java para esse tipo de trabalho são o <a href="https://github.com/cglib/cglib">CGLIB</a> e o <a href="https://github.com/jboss-javassist/javassist">javassist</a>, utilizados em vários frameworks (como o Spring e o Hibernate).</p>

<p>O Mockito, desde a primeira versão, usava o CGLIB como ferramenta de construção de mocks; a partir da versão 2, a biblioteca utilizada passou a ser o <a href="http://bytebuddy.net/">ByteBuddy</a>. As principais justificativas para a mudança são que o CGLIB, de fato, tem algumas limitações em relação ao bytecode gerado nas versões mais recentes do Java, além do ByteBuddy permitir a correção de alguns bugs de longa data do Mockito (que não eram passíveis de correções por limitações do CGLIB).</p>

<p>Mas, apesar de realmente ser uma mudança de alto impacto, o que isso muda para os nossos testes? A princípio, nada. Como a construção de mocks/proxies de objetos é feita internamente pelo Mockito, a maneira como os mocks são gerados não tem nenhum efeito direto sobre como nossos testes são escritos. Não obstante, essa mudança teve o efeito positivo de introduzir uma novidade, ainda que em caráter experimental: permitir mockar classes <em>final</em>! :)</p>

<pre><code class="language-java">public final class Sample {

	public final String bla() {
		return &quot;bla&quot;;
	}
}

public class SampleTest {

	@Test
	public void test() {
		Sample sampleMock = Mockito.mock(Sample.class);
		when(sampleMock.bla()).thenReturn(&quot;foo&quot;);

		String output = sampleMock.bla();

		assertEquals(&quot;foo&quot;, output);
	}
}
</code></pre>

<p>Nas versões 1.x do Mockito, o teste acima simplesmente não funcionaria, pois seria impossível mockar a classe Sample ou mesmo o método &ldquo;bla()&rdquo;. Isto porquê o mecanismo de proxy do CGLIB se baseia em criar, em tempo de execução, uma subclasse do objeto proxificado; como não é possível criar uma subclasse de uma classe <em>final</em>, ou sobrescrever um método marcado como <em>final</em>, não era possível implementar um teste como o do exemplo acima apenas com o Mockito. Para contornar essa limitação, uma biblioteca muito utilizada é o <a href="http://powermock.github.io/">PowerMock</a> (com a extensão <a href="http://www.javadoc.io/doc/org.powermock/powermock-api-mockito/1.6.4">PowerMockito</a>), que tem como premissa &ldquo;testar o não-testável&rdquo;, incluindo <a href="https://github.com/powermock/powermock/wiki/mockfinal">classes e métodos final</a> como no exemplo.</p>

<p>Como dito antes, o mock de classes/métodos <em>final</em> está em fase de testes no Mockito. Para habilitá-la, você deve ativar um mecanismo semelhante ao <a href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html">ServiceLoader</a> do Java:
- no seu classpath de teste, crie uma pasta chamada mockito-extensions, e dentro dela um arquivo chamado org.mockito.plugins.MockMaker (se o seu projeto utiliza Maven ou Gradle, por exemplo, o local desse arquivo seria &ldquo;src/test/resources/mockito-extensions/org.mockito.plugins.MockMaker&rdquo;)
- o conteúdo desse arquivo deve ser uma única linha contendo: <strong>mock-maker-inline</strong></p>

<p>A presença desse arquivo irá sobrescrever o <a href="http://static.javadoc.io/org.mockito/mockito-core/2.7.22/org/mockito/plugins/MockMaker.html">MockMaker</a> padrão utilizado pelo Mockito. Essa interface foi projetada para servir como um ponto de extensão do framework, permitindo customizar a maneira como os mocks são criados.</p>

<p>Com a configuração acima, o Mockito irá utilizar uma implementação especialmente projetada para usar uma combinação de subclasses e instrumentação (através de um Java Agent). Mas não se preocupe: essas complexidades de baixo nível são invisíveis para o teste, e finalmente seremos capazes de mockar nossas classes e métodos <em>final</em> (como o exemplo acima) sem recorrer a outras bibliotecas!</p>

<p>Uma maneira simplificada de utilizar esse recurso é incluir a dependência <em>mockito-inline</em> no seu classpath. Esse artefato irá configurar o arquivo org.mockito.plugins.MockMaker como demonstrado acima.</p>

<p>Para mais detalhes: <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/Mockito.html#Mocking_Final">Mock the unmockable</a></p>

<h2 id="stubs-não-utilizados">Stubs não utilizados</h2>

<p>Um dos objetivos da nova versão do Mockito é ajudar os desenvolvedores a escrever testes melhores. Um dos pontos de atenção para manter os testes limpos e fáceis de entender é evitar código não utilizado, como configurações de mocks que não são usados na execução do programa. Vejamos um exemplo:</p>

<pre><code class="language-java">public class Dictionary {

	private final Translator translator;

	public Dictionary(Translator translator) {
		this.translator = translator;
	}

	public String get(String word) {
		return translator.translate(word);
	}
}
</code></pre>

<p>E nosso teste:</p>

<pre><code class="language-java">@RunWith(MockitoJUnitRunner.class)
public class DictionaryTest {

	@Mock
	private Translator translator;

	@InjectMocks
	private Dictionary dictionary;

	@Test
	public void test() {
		String word = &quot;ola&quot;;

		when(translator.translate(word)).thenReturn(&quot;hello&quot;);

		String output = dictionary.get(word);

		assertNotNull(output);
	}
}
</code></pre>

<p>Nossa classe Dictionary, no método &ldquo;get&rdquo;, utiliza uma instância do Translator (uma interface; a implementação do Translator não é relevante para nós) para &ldquo;traduzir&rdquo; a palavra enviada como parâmetro. Utilizamos o Mockito para configurar o método &ldquo;translate&rdquo; do Translator, para devolver a String &ldquo;hello&rdquo; quando o método for invocado com a palavra &ldquo;word&rdquo;. O teste apenas verifica se a resposta do método é não-nula (um teste frágil mas atende nosso exemplo por hora). O teste acima passaria sem problema. Mas, e se nosso código fosse modificado da seguinte forma:</p>

<pre><code class="language-java">public class Dictionary {

	private final Translator translator;

	public Dictionary(Translator translator) {
		this.translator = translator;
	}

	public String get(String word) {
		return &quot;ooops&quot;;
	}
}
</code></pre>

<p>Perceba que o método &ldquo;get&rdquo; não utiliza mais o Translator. Este seria um bug que nosso teste não detectaria, por dois motivos: 1) o teste apenas confirma que a saída do método é uma String não-nula, o que continua acontecendo, e 2) o teste não verifica se o mock foi efetivamente invocado (usando o Mockito.verify). O ponto que quero ressaltar aqui é que a detecção do bug, nesse caso, <strong>depende do teste estar bem escrito</strong>. Isso pode parecer apenas senso comum, mas é muito fácil deixar passar esse tipo de detalhe, às vezes por simples desatenção momentânea, por não realizarmos completamente o ciclo do TDD (red-green-refactor), ou por desconhecimento de eventuais recursos dos frameworks envolvidos.</p>

<p>Por outro lado, a mudança que realizamos acima também poderia ser uma refatoração válida: digamos que nosso Dictionary realmente não irá mais utilizar o Translator e irá implementar sua lógica interna de outro modo. Em nosso teste, teríamos um mock não utilizado, com a configuração desnecessária poluindo o código. Agora, o Mockito é capaz de detectar esse tipo de situação.</p>

<p>Se executarmos novamente nosso DictionaryTest (após a mudança acima na classe Dictionary), teríamos como saída do teste:</p>

<p><img src="../images/testes-codigo-mockito-2-1.png" alt="mockito-2-output-unused-stub" /></p>

<p>O teste irá passar, mas será exibido no relatório do Junit a seguinte mensagem:</p>

<pre><code class="language-java">org.mockito.exceptions.misusing.UnnecessaryStubbingException:
Unnecessary stubbings detected in test class: DictionaryTest
Clean &amp; maintainable test code requires zero unnecessary code.
Following stubbings are unnecessary (click to navigate to relevant line of code):
  1. -&gt; at com.elo7.mockito.sample.DictionaryTest.test(DictionaryTest.java:25)
Please remove unnecessary stubbings or use 'silent' option. More info: javadoc for UnnecessaryStubbingException class.
	at org.mockito.internal.runners.StrictRunner.run(StrictRunner.java:49)
	at org.mockito.junit.MockitoJUnitRunner.run(MockitoJUnitRunner.java:161)
	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:86)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:459)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:678)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:382)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:192)

</code></pre>

<p>Além da mensagem bastante explicativa, o erro também inclui a linha da classe com a configuração desnecessária do mock. Reforçando: essa mensagem de &ldquo;stubs não utilizados&rdquo; será exibida <strong>apenas se o teste passar</strong> (essa decisão foi justificada pela equipe do Mockito tendo em mente que, se o teste falhar, exibir a mensagem de falha em conjunto com o erro relativo aos stubs poderia gerar confusão ao usuário).</p>

<p>Então, agora temos o recurso do Mockito para nos ajudar a limpar o código de teste (se for o caso), indicando configurações de mocks (os tais &ldquo;stubs&rdquo;) não utilizados. Mas e se o teste ainda não estiver passando? Um problema em potencial poderia ser uma eventual configuração incorreta do mock; ou seja, o mock está sendo utilizado no código mas não da maneira como foi &ldquo;stubado&rdquo;. Digamos, algo assim:</p>

<pre><code class="language-java">public class Dictionary {

	private final Translator translator;

	public Dictionary(Translator translator) {
		this.translator = translator;
	}

	public String get(String word) {
		return translator.translate(word);
	}
}
</code></pre>

<p>Novamente, nosso teste:</p>

<pre><code class="language-java">@RunWith(MockitoJUnitRunner.class)
public class DictionaryTest {

	@Mock
	private Translator translator;

	@InjectMocks
	private Dictionary dictionary;

	@Test
	public void test() {
		String word = &quot;ola&quot;;

		when(translator.translate(word)).thenReturn(&quot;hello&quot;);

		String output = dictionary.get(&quot;oi&quot;);

		assertNotNull(output);
	}
}
</code></pre>

<p>O teste acima irá falhar. A resposta do método &ldquo;get&rdquo; do Dictionary será <em>null</em>, porque configuramos o Translator para devolver &ldquo;hello&rdquo; <strong>somente</strong> quando o método &ldquo;translate&rdquo; for invocado com o parâmetro &ldquo;ola&rdquo;, o que não foi o caso já que enviamos a String &ldquo;oi&rdquo;. O Mockito 2 também é capaz de nos auxiliar nessa situação, indicando que o mock foi utilizado, mas não da maneira como foi configurado. Ao rodar o teste acima, a seguinte mensagem será exibida no console:</p>

<pre><code class="language-java">[MockitoHint] DictionaryTest.test (see javadoc for MockitoHint):
[MockitoHint] 1. Unused... -&gt; at com.elo7.mockito.sample.DictionaryTest.test(DictionaryTest.java:25)
[MockitoHint]  ...args ok? -&gt; at com.elo7.mockito.sample.Dictionary.get(Dictionary.java:12)
</code></pre>

<p>Nessa mensagem, o Mockito incluiu o ponto do código onde o mock é configurado, e o ponto onde está sendo utilizado (incorretamente ou, no mínimo, de modo diferente do que foi configurado). Esse relatório é extremamente útil, principalmente para testes mais complexos (casos em que os programadores, invariavelmente, debugam o código para encontrar o problema). Ao contrário do exemplo anterior, esse relatório de &ldquo;stubs mal utilizados&rdquo;, se for o caso, será exibido no console (fora da saída do Junit) <strong>somente quando o teste falhar</strong>.</p>

<p>Caso prefira não utilizar a verificação de &ldquo;stubs não utilizados/mal utilizados&rdquo; (habilitado por padrão), você pode usar o Mockito no modo &ldquo;silencioso&rdquo;:</p>

<pre><code class="language-java">@RunWith(MockitoJUnitRunner.Silent.class)
public class DictionaryTest {
}
</code></pre>

<h2 id="matchers-do-hamcrest">Matchers do Hamcrest</h2>

<p>Uma dor de cabeça recorrente das versões 1.x do Mockito era o conflito de versões do <a href="http://hamcrest.org/JavaHamcrest/">Hamcrest</a>, uma biblioteca de <em>argument matchers</em>. Esses conflitos ocorriam porque o Mockito dependia explicitamente do Hamcrest (em função do método <a href="http://static.javadoc.io/org.mockito/mockito-core/1.10.19/org/mockito/Matchers.html#argThat(org.hamcrest.Matcher)">Matchers.argThat</a>, que aceita como parâmetro um matcher), mas as classes principais do Hamcrest são carregadas dentro do jar do JUnit (para serem utilizadas no método <a href="http://junit.org/junit4/javadoc/latest/org/junit/Assert.html#assertThat(T,%20org.hamcrest.Matcher)">Assert.assertThat</a>), o que eventualmente gerava um pequeno e clássico &ldquo;classpath hell&rdquo; (já que o Mockito dependia de uma versão e o JUnit de outra).</p>

<p>Essa dependência foi removida e o método <em>Matchers.argThat</em> (que recebia como parâmetro um matcher do Hamcrest) foi depreciado. Se quiser utilizar o Hamcrest no seu projeto, você mesmo deve incluí-lo no seu classpath de testes, e utilizar a nova classe <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/hamcrest/MockitoHamcrest.html">MockitoHamcrest</a>.</p>

<p>A respeito da depreciação do método <em>Matchers.argThat</em>: na verdade, a classe Matchers foi inteiramente depreciada. Essa classe era extendida pela classe Mockito (a classe principal do framework), que na versão 2, passa a extender a classe <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/ArgumentMatcher.html">ArgumentMatchers</a>.</p>

<h2 id="answers-returns-self">Answers.RETURNS_SELF</h2>

<p>No meu post anterior, explorei a abstração <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/stubbing/Answer.html">Answer</a> e as várias opções possíveis para configurar a resposta dos métodos de um mock. Na versão 2, o Mockito introduziu uma nova opção chamada <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/Mockito.html#RETURNS_SELF">RETURNS_SELF</a>, que é particularmente útil para testes envolvendo Builders.</p>

<pre><code class="language-java">@RunWith(MockitoJUnitRunner.class)
public class SomeTest {

	@Mock(answer = Answers.RETURNS_SELF)
	private Builder builder;

}
</code></pre>

<p>O comportamento dessa resposta é: se algum método <strong>não configurado</strong> desse mock for invocado,</p>

<ul>
<li>Se o retorno do método for algum tipo <strong>igual à classe ou superclasse</strong> do mock, retorna a <strong>mesma instância</strong> do mock;</li>
<li>Para qualquer outro caso, seguirá o mesmo comportamento da configuração padrão do Mockito (<a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/Mockito.html#RETURNS_DEFAULTS">RETURNS_DEFAULTS</a>).</li>
</ul>

<p>Considere o exemplo abaixo, extraído da documentação:</p>

<pre><code class="language-java">public class HttpBuilder {

	private String uri;

	private List&lt;String&gt; headers;

	public HttpBuilder() {
		this.headers = new ArrayList&lt;&gt;();
	}

	public HttpBuilder withUrl(String uri) {
		this.uri = uri;
		return this;
	}

	public HttpBuilder withHeader(String header) {
		this.headers.add(header);
		return this;
	}

	public String request() {
		return uri + headers.toString();
	}
}

public class HttpRequestWithHeaders {

	private final HttpBuilder builder;

	public HttpRequestWithHeaders(HttpBuilder builder) {
		this.builder = builder;
	}

	public String request(String uri) {
		return builder.withUrl(uri)
				.withHeader(&quot;Content-type: application/json&quot;)
				.withHeader(&quot;Authorization: Bearer&quot;)
				.request();
	}
}
</code></pre>

<p>E o teste:</p>

<pre><code class="language-java">@RunWith(MockitoJUnitRunner.class)
public class SomeTest {

	@Mock(answer = Answers.RETURNS_SELF)
	private HttpBuilder builder;

	@Test
	public void test() {
  		HttpRequesterWithHeaders requester = new HttpRequestWithHeaders(builder);

  		String response = &quot;StatusCode: 200&quot;;

		//permite configurar apenas o método &quot;request&quot; do mock, pois cada método utilizado devolve a mesma instância
  		when(builder.request()).thenReturn(response);

  		assertThat(requester.request(&quot;URI&quot;)).isEqualTo(response);
	}
}
</code></pre>

<p>O mock de Builders já era relativamente possível usando a answer <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/Mockito.html#RETURNS_DEEP_STUBS">RETURNS_DEEP_STUBS</a> (que expliquei com maiores detalhes no post anterior). A principal diferença é que o RETURNS_DEEP_STUBS devolve um <strong>novo mock</strong> para cada método invocado, de modo que você precisaria navegar pela cadeia de invocações caso quisesse mockar um método específico. Com o RETURNS_SELF, isso não é necessário.</p>

<p>Como ponto de atenção, reforço o que foi explicado acima: essa answer terá efeito <strong>apenas para os métodos que devolvem o mesmo tipo da classe mockada</strong>.</p>

<h2 id="spy">Spy</h2>

<p>A nova versão do Mockito traz uma mudança muito interessante sobre os <em>spies</em> (se você não os conhece, meu <a href="/testes-codigo-mockito/">post anterior</a> explica detalhadamente o que são &ldquo;objetos espiões&rdquo; e como utilizá-los). Agora, é possível &ldquo;espiar&rdquo; uma classe abstrata, o que antes não era possível. Considere o exemplo abaixo, com uma implementação do pattern <a href="https://pt.wikipedia.org/wiki/Template_Method">Template Method</a>. A idéia desse padrão é &ldquo;definir o esqueleto de um algoritmo, delegando alguns passos para as subclasses&rdquo;.</p>

<pre><code class="language-java">public abstract class DocumentGenerator {

	public Document generate() {
		// esse método define a código-base da geração de documentos, usando os métodos implementados nas subclasses
		StringBuilder builder = new StringBuilder();

		builder.append(header())
			   .append(body())
			   .append(footer());

		return new Document(builder.toString());
	}

	protected abstract String header();

	protected abstract String body();

	protected abstract String footer();
}

public class HtmlDocumentGenerator extends DocumentGenerator {

	@Override
	protected String header() {
		// Gera o cabeçalho do documento no formato HTML
		return null;
	}

	@Override
	protected String body() {
		// Gera o corpo do documento no formato HTML
		return null;
	}

	@Override
	protected String footer() {
		// Gera o rodapé do documento no formato HTML
		return null;
	}

}

public class XmlDocumentGenerator extends DocumentGenerator {

	@Override
	protected String header() {
		// Gera o cabeçalho do documento no formato XML
		return null;
	}

	@Override
	protected String body() {
		// Gera o cabeçalho do documento no formato XML
		return null;
	}

	@Override
	protected String footer() {
		// Gera o cabeçalho do documento no formato XML
		return null;
	}
}
</code></pre>

<p>Suponhamos que desejamos testar o método &ldquo;generate&rdquo; da classe DocumentGenerator, pois esee método representa a geração do documento completa (de qualquer tipo). Uma idéia válida seria usarmos um <em>partial mock</em> do DocumentGenerator, mockando os métodos auxiliares do algoritmo (no caso, &ldquo;header()&rdquo;, &ldquo;body()&rdquo; e &ldquo;footer()&rdquo;). Poderíamos utilizar o <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/Spy.html">@Spy</a> do Mockito, que nos permitir usar a implementação real do método &ldquo;generate&rdquo; e configurarmos os outros:</p>

<pre><code class="language-java">@RunWith(MockitoJUnitRunner.class)
public class DocumentGeneratorTest {

	@Spy
	private DocumentGenerator documentGenerator;

	@Test
	public void test() {
		doReturn(&quot;[header]&quot;).when(documentGenerator).header();
		doReturn(&quot;[body]&quot;).when(documentGenerator).body();
		doReturn(&quot;[footer]&quot;).when(documentGenerator).footer();

		Document document = documentGenerator.generate();

		assertEquals(&quot;[header][body][footer]&quot;, document.toString());
	}
}
</code></pre>

<p>No Mockito 1.x, essa configuração não vai funcionar, porque <strong>não é possível criar um spy a partir de uma classe abstrata</strong>. A &ldquo;solução&rdquo; seria criar um &ldquo;objeto stub&rdquo;, que extende DocumentGenerator, para utilizarmos no teste:</p>

<pre><code class="language-java">public class DocumentGeneratorTest {

	private final DocumentGenerator documentGenerator = new DummyDocumentGenerator();

	@Test
	public void test() {
		Document document = documentGenerator.generate();

		assertEquals(&quot;[header][body][footer]&quot;, document.toString());
	}

	private class DummyDocumentGenerator extends DocumentGenerator {

		@Override
		protected String header() {
			return &quot;[header]&quot;;
		}

		@Override
		protected String body() {
			return &quot;[body]&quot;;
		}

		@Override
		protected String footer() {
			return &quot;[footer]&quot;;
		}

	}
}
</code></pre>

<p>No Mockito 2.x, podemos criar um spy a partir de uma classe abstrata, e o teste inicial (exemplo anterior) rodaria sem problemas. No exemplo, a criação foi feita com a anotação @Spy; nesse caso, a única restrição é que a classe abstrata <strong>deve ter um construtor padrão (sem argumentos)</strong>. Se não for o caso, você ainda pode utilizar a <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/Mockito.html#spying_abstract_classes">API programática do Mockito</a>:</p>

<pre><code class="language-java">public class SomeAbstractType {

	private final String arg;
	private final int otherArg;

	public SomeAbstractType(String arg, int otherArg) {
		this.arg = arg;
		this.otherArg = otherArg;
	}
}

public class SomeAbstractTypeTest {

	@Test
	public void anyTest() {
		SomeAbstractType spy = mock(SomeAbstractType.class, withSettings().useConstructor(&quot;arg1&quot;, 123).defaultAnswer(Answers.CALLS_REAL_METHODS));
	}
}
</code></pre>

<h2 id="verificação-de-métodos">Verificação de métodos</h2>

<p>A verificação de métodos dos mocks (realizada pelo método <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/Mockito.html#verify(T)">Mockito.verify</a>) consiste em <strong>confirmar que os mocks foram invocados adequadamente</strong>, e é extremamente importante em alguns cenários de teste (em outros, nem tanto). Uma melhoria introduzida na versão 2 do Mockito é a possibilidade de verificação &ldquo;lazy&rdquo;. Abaixo, um exemplo dessa funcionalidade:</p>

<pre><code class="language-java">public class User {

	private final String name;
	private final String email;

	public User(String name, String email) {
		this.name = name;
		this.email = email;
	}

	public String getName() {
		return name;
	}

	public String getEmail() {
		return email;
	}
}

public interface UserRepository {

	User save(User user);

}

public interface UserEmailSender {

	void sendTo(User user);

}

public class UserService {

	private final UserRepository userRepository;
	private final UserEmailSender userEmailSender;

	public UserService(UserRepository userRepository, UserEmailSender userEmailSender) {
		this.userRepository = userRepository;
		this.userEmailSender = userEmailSender;
	}

	public User persist(User user) {
		/* aqui vamos usar o UserRepository para persistir o usuário na nossa base de dados,
		 e o UserEmailSender para enviar um e-mail de boas vindas.
		 Mas o código ainda não está implementado! */

		return null;
	}
}
</code></pre>

<p>Nosso teste:</p>

<pre><code class="language-java">@RunWith(MockitoJUnitRunner.class)
public class UserServiceTest {

	@Mock
	private UserRepository userRepository;

	@Mock
	private UserEmailSender userEmailSender;

	@InjectMocks
	private UserService userService;

	@Test
	public void shouldCreateNewUser() {
		User user = new User(&quot;Tiago de Freitas Lima&quot;, &quot;tiago.lima@elo7.com&quot;);
		User newUser = new User(1l, &quot;Tiago de Freitas Lima&quot;, &quot;tiago.lima@elo7.com&quot;);

		when(userRepository.save(user)).thenReturn(newUser);

		User persistedUser = userService.persist(user);

		verify(userRepository).save(user);
		verify(userEmailSender).sendTo(newUser);
	}

}
</code></pre>

<p>Implementamos nosso teste pensando no comportamento esperado do método UserService.persist; enviamos um usuário, queremos que ele seja persistido no repositório de dados e que seja enviado um email ao usuário criado. O teste irá falhar, pois o código ainda não foi implementado. E irá falhar na primeira verificação:</p>

<pre><code class="language-java">public class UserServiceTest {

	//...código omitido

	@Test
	public void shouldCreateNewUser() {
		//...código omitido
		verify(userRepository).save(user); // falha aqui - o método do mock não foi invocado
		verify(userEmailSender).sendTo(newUser); // essa verificação não é executada
	}
}
</code></pre>

<p>O erro no JUnit, indicando a verificação do Mockito que falhou:</p>

<pre><code class="language-java">Wanted but not invoked:
userRepository.save(
    com.elo7.mockito.sample.User@222545dc
);
-&gt; at com.elo7.mockito.sample.UserServiceTest.shouldCreateNewUser(UserServiceTest.java:37)
Actually, there were zero interactions with this mock.
</code></pre>

<p>Ao implementarmos um teste dessa forma (<a href="http://www.extremeprogramming.org/rules/testfirst.html">test-first</a>), seria útil visualizarmos todas as interações de mocks que ainda não estão implementadas no código. No exemplo acima, seria de muito valor que o Mockito nos informasse, no seu relatório de erro, que tanto o UserRepository quanto o UserEmailSender não estão sendo utilizados. No Mockito 2, isso é possível usando uma <a href="https://github.com/junit-team/junit4/wiki/rules">@Rule</a> especial chamada <a href="http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/junit/VerificationCollector.html">VerificationCollector</a>:</p>

<pre><code class="language-java">@RunWith(MockitoJUnitRunner.class)
public class UserServiceTest {

	@Mock
	private UserRepository userRepository;

	@Mock
	private UserEmailSender userEmailSender;

	@InjectMocks
	private UserService userService;

	@Rule
	public VerificationCollector collector = MockitoJUnit.collector(); //basta declarar a rule

	@Test
	public void shouldCreateNewUser() {
		User user = new User(&quot;Tiago de Freitas Lima&quot;, &quot;tiago.lima@elo7.com&quot;);
		User newUser = new User(1l, &quot;Tiago de Freitas Lima&quot;, &quot;tiago.lima@elo7.com&quot;);

		when(userRepository.save(user)).thenReturn(newUser);

		userService.persist(user);

		verify(userRepository).save(user); //essa verificação irá falhar, mas a execução do teste vai continuar
		verify(userEmailSender).sendTo(newUser); //essa verificação também falhará, mas novamente a execução não será interrompida
	}
}
</code></pre>

<p>Agora, na saída no JUnit, o erro lançado pelo Mockito irá indicar os dois mocks não utilizados:</p>

<pre><code class="language-java">org.mockito.exceptions.base.MockitoAssertionError: There were multiple verification failures:
1. Wanted but not invoked:
userRepository.save(
    com.elo7.mockito.sample.User@564fabc8
);
-&gt; at com.elo7.mockito.sample.UserServiceTest.shouldCreateNewUser(UserServiceTest.java:39)
Actually, there were zero interactions with this mock.
2. Wanted but not invoked:
userEmailSender.sendTo(
    com.elo7.mockito.sample.User@436813f3
);
-&gt; at com.elo7.mockito.sample.UserServiceTest.shouldCreateNewUser(UserServiceTest.java:40)
Actually, there were zero interactions with this mock.
</code></pre>

<p>Um detalhe importante do exemplo acima: para fins de exemplo, não inclui nenhum <em>assert</em>. Supondo que eu fizesse alguma asserção e ela falhasse (por exemplo, <em>assertNotNull</em> no retorno do método), os eventuais problemas de verificação <strong>não seriam exibidos</strong>, apenas a falha do teste. Então, os erros da verificação &ldquo;lazy&rdquo;, gerados pelo Mockito <strong>após</strong> o teste, serão exibidos apenas se não ocorrer nenhum outro problema.</p>

<h2 id="e-mais-mudanças">E mais mudanças&hellip;</h2>

<ul>
<li><p>A nova versão é compatível apenas com Java 6 ou superior (a versão 1.x é compatível com Java 5)</p></li>

<li><p>Os matchers <em>anyX()</em> (anyString(), anyInt(), etc) e <em>any(AlgumTipo.class)</em> passam a <strong>rejeitar valores nulos</strong>. Exemplos:
```java
public interface Translator {</p></li>
</ul>

<p>	String translate(String word);</p>

<p>}</p>

<p>@RunWith(MockitoJUnitRunner.class)
public class SomeTest {</p>

<p>	@Mock
	private Translator translator;</p>

<p>	@Test
	public void test() {
		translator.translate(null);</p>

<p>		verify(translator).translate(anyString()); // falha -&gt; null não é &ldquo;qualquer String&rdquo;
		verify(translator).translate(any()); // sucesso -&gt; null é &ldquo;qualquer&rdquo;
	}
}</p>

<pre><code>
* O método *getArgumentAt*, da classe [InvocationOnMock](http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/invocation/InvocationOnMock.html) foi renomeado e teve sua assinatura alterada para inferir o tipo de retorno de forma implícita (ao invés de receber um argumento do tipo Class). Essa mudança é muito importante caso você implemente respostas customizadas. Também foram criadas novas [Answers](http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/stubbing/Answer1.html) para métodos com múltiplos argumentos.

* Para fins de depuração, caso você queira visualizar todas as invocações do seu mock, você pode utilizar o novo método [MockingDetails.printInvocations](http://static.javadoc.io/org.mockito/mockito-core/2.8.47/org/mockito/MockingDetails.html#printInvocations()):

```java
@RunWith(MockitoJUnitRunner.class)
public class SomeTest {

	@Mock
	private Translator translator;

	@Test
	public void test() {
		translator.translate(&quot;ola&quot;);

		System.out.println(Mockito.mockingDetails(translator).printInvocations());
	}
}
</code></pre>

<p>A saída no console:</p>

<pre><code class="language-java">[Mockito] Interactions of: translator
 1. translator.translate(&quot;ola&quot;);
  -&gt; at com.elo7.mockito.sample.SomeTest.test(SomeTest.java:17)
</code></pre>

<ul>
<li>Se você está utilizando o Mockito no Android, a versão 2 traz algumas customizações de geração de bytecode específicas para a JVM do Android. Para utilizar, basta importar o artefato <em>mockito-android</em>.</li>
</ul>

<h2 id="conclusão">Conclusão</h2>

<p>O Mockito é um dos frameworks de mocks mais utilizados na linguagem Java, muito devido à simplicidade na sua utilização e grande número de recursos. A versão 2.x manteve essa linha de implementação, além de trazer novas e interessantes funcionalidades para ajudar os desenvolvedores a escrever mais e melhores testes. Nesse post, cobri as principais mudanças e novidades da nova versão. Espero que tenha gostado! Em caso de dúvidas ou qualquer outra coisa, sinta-se à vontade para usar a caixa de comentários!</p>


                        <ul class='tag-list'>
                            
                                <li>
                                    <a href='/tags/java/'>java</a>
                                </li>
                            
                                <li>
                                    <a href='/tags/mockito/'>mockito</a>
                                </li>
                            
                                <li>
                                    <a href='/tags/tdd/'>tdd</a>
                                </li>
                            
                        </ul>
                        <section class='share'>
                            <a href='#share' class='share-post hide' title='Clique aqui para compartilhar esse post'>Compartilhe</a>
                            <div class='social-share'>
                                <a href='https://www.facebook.com/dialog/share?app_id=644444999041914&href=https%3a%2f%2felo7.dev%2ftestes-codigo-mockito-2%2f&display=popup' rel='noopener' target='_blank' class='link-share facebook' title='Clique para compartilhar no Facebook'>
                                    Compartilhar no facebook
                                </a>
                                <a href='https://twitter.com/intent/tweet?text=testes-de-c%25C3%25B3digo-com-mockito-2-novidades-da-nova-vers%25C3%25A3o&url=https%3a%2f%2felo7.dev%2ftestes-codigo-mockito-2%2f&hashtags=elo7tech' rel='noopener' target='_blank' class='link-share twitter' title='Clique para compartilhar no Twitter'>
                                    Compartilhar no twitter
                                </a>
                                <a href='https://elo7.dev/testes-codigo-mockito-2/?utm_source=share&utm_medium=copy' class='link-share hide copy' title='Clique para copiar a url'>
                                    Copiar URL
                                </a>
                                <span class='copy-success'>Link copiado</span>
                                <input type='url' value='https://elo7.dev/testes-codigo-mockito-2/?utm_source=share&utm_medium=copy' class='link-input'>
                            </div>
                        </section>
                    </div>
                    <meta itemprop='headline' content='Há algum tempo, escrevi sobre o funcionamento e os principais recursos do Mockito. Neste post, vamos conhecer as novidades da nova versão do framework.'/>
                    <span itemprop='publisher' itemscope itemtype='http://schema.org/Organization'>
                        <meta itemprop='name' content='Elo7 Tech'/>
                        <meta itemprop='url' content='https://elo7.dev/'/>
                        <span itemprop='logo' itemscope itemtype='http://schema.org/ImageObject'>
                            <link href='https://images.elo7.com.br/assets/v3/desktop/png/logo-elo7.png' itemprop='url'/>
                            <meta itemprop='width' content='100px'/>
                            <meta itemprop='height' content='100px'/>
                        </span>
                    </span>
                    <meta itemprop='mainEntityOfPage' content='Elo7 Serviços de Informática SA'/>

                    <div id='disqus_thread'></div>
                </div>
            </article>
        </main>

        <footer itemscope itemtype='http://schema.org/Organization'>
    <a rel='home' itemprop='url' href='https://elo7.dev/' >
        elo7.dev © <script>now = new Date; document.write(now.getFullYear());</script>
    </a>
    <meta itemprop='name' content='Elo7 Serviços de Informática SA'/>
    <section class='footer-social'>
        <a title='Github do Elo7' rel='external' itemprop='url' href='https://github.com/elo7' target='_blank' class='github'>Github do Elo7</a>
        <a title='Twitter do Elo7' rel='external' itemprop='url' href='https://twitter.com/elo7tech' target='_blank' class='twitter'>Twitter do Elo7</a>
        <a title='RSS do Elo7' rel='external' itemprop='url' href='https://elo7.dev/index.xml' target='_blank' class='rss'>RSS do Elo7</a>
        <a title='Newsletter do Elo7' rel='external' itemprop='url' href='http://eepurl.com/cVUwvH' target='_blank' class='email'>Newsletter do Elo7</a>
    </section>
</footer>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script async src='/js/analytics.js'></script>
<script async src='/js/github.js'></script>
<script async src='/js/vendor/events-amd.js'></script>
<script async src='/js/vendor/ajax.js'></script>
<script async src='/js/vendor/doc.js'></script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src='/js/vendor/highlight.js'></script>
<script>hljs.initHighlightingOnLoad();</script>


        <script>
            var disqus_shortname = 'engenhariaelo7';
            var disqus_identifier = '2017-08-21 00:00:00 \x2b0000 UTC:\/testes-codigo-mockito-2\/';
            var disqus_url = 'https:\/\/elo7.dev\/testes-codigo-mockito-2\/';

            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Habilite o JavaScript para ver os comentários</noscript>
        <script async src='/js/post.js'></script>
    </body>
</html>

<!DOCTYPE html>
<html>
    <head>
	<meta charset='UTF-8'>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<meta name='description' content='Blog de tecnologia do Elo7, mantido pelo nosso time de Engenharia, compartilhando conhecimento e mostrando como é o dia a dia de um colaborador fora de série.'>
	<meta name='google-site-verification' content='NqCILBTY8B8P-r_KF8BSZKH9kUQgQOEbXJvEMaB33vw'>
	<meta name='google-site-verification' content='cKh-stJM3_ENNfMjaBIIyYiDgMXZFpRkoH8eQTcPwhM' />
	<meta name="google-site-verification" content="6Er6NBhORIKrEwdS46h772O_7LTE9vWgZjwtzuZ5gpQ" />
	<meta name='theme-color' content='#FDC24F'>
	<meta name='keywords' content='Elo7,tecnologia,post,desenvolvimento,blog,analytics,kafka,flink,elasticsearch,kibana,'>
	<meta name='language' content='pt-br'>
	<meta name='title' content='Elo7 Tech - Elo7 &#43; Analytics = Elytics'>
	<meta name='apple-mobile-web-app-title' content='Elo7 Tech - Elo7 &#43; Analytics = Elytics'>
	<meta name='mobile-web-app-capable' content='yes'>

	<meta property='fb:app_id' content='644444999041914'>
	<meta property='fb:admins' content='100003324447975'>

	<meta property='og:site_name' content='Elo7 Tech'>
	<meta property='og:image' content='https://elo7.dev/images/cover/elo7.png'>
	<meta property='og:type' content='website'>
	<meta property='og:title' content='Elo7 Tech - Elo7 &#43; Analytics = Elytics'>
	<meta property='og:url' content='https://elo7.dev/elo7-analytics-elytics/'>
	<meta property='og:description' content='Blog de tecnologia do Elo7, mantido pelo nosso time de Engenharia, compartilhando conhecimento e mostrando como é o dia a dia de um colaborador fora de série.'>

	<meta name='twitter:widgets:csp' content='on'>
	<meta name='twitter:card' content='summary_large_image'>

	<meta property='twitter:title' content='Elo7 Tech - Elo7 &#43; Analytics = Elytics'>
	<meta property='twitter:domain' content='https://elo7.dev/'>
	<meta property='twitter:url' content='https://elo7.dev/elo7-analytics-elytics/'>
	<meta property='twitter:description' content='Blog de tecnologia do Elo7, mantido pelo nosso time de Engenharia, compartilhando conhecimento e mostrando como é o dia a dia de um colaborador fora de série.'>
	<meta property='twitter:image' content='https://elo7.dev/images/cover/elo7.png'>

	<link rel='canonical' href='https://elo7.dev/elo7-analytics-elytics/'>
	<title>Elo7 Tech - Elo7 &#43; Analytics = Elytics</title>
	<link rel='stylesheet' href='https://elo7.dev/css/reset.css'>
	<link rel='stylesheet' href='https://elo7.dev/css/vendor/highlight.css' >
	<link rel='stylesheet' href='https://elo7.dev/css/main.css' >
	<link rel='stylesheet' href='https://elo7.dev/css/posts.css' >
	<link rel='stylesheet' href='https://elo7.dev/css/post.css' >
	<link rel='stylesheet' href='https://elo7.dev/css/publisher.css' >
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-16.png' sizes='16x16'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-32.png' sizes='32x32'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-48.png' sizes='48x48'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-64.png' sizes='64x64'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-96.png' sizes='96x96'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-128.png' sizes='128x128'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-160.png' sizes='160x160'>
	<link rel='icon' href='https://elo7.dev/images/favicon/favicon-192.png' sizes='192x192'>
	<link rel='apple-touch-icon-precomposed' sizes='180x180' href='https://elo7.dev/images/favicon/favicon-180.png'>
	<link rel='apple-touch-icon-precomposed' sizes='152x152' href='https://elo7.dev/images/favicon/favicon-152.png'>
	<link rel='apple-touch-icon-precomposed' sizes='144x144' href='https://elo7.dev/images/favicon/favicon-144.png'>
	<link rel='apple-touch-icon-precomposed' sizes='120x120' href='https://elo7.dev/images/favicon/favicon-120.png'>
	<link rel='apple-touch-icon-precomposed' sizes='114x114' href='https://elo7.dev/images/favicon/favicon-114.png'>
	<link rel='apple-touch-icon-precomposed' sizes='76x76' href='https://elo7.dev/images/favicon/favicon-76.png'>
	<link rel='apple-touch-icon-precomposed' sizes='72x72' href='https://elo7.dev/images/favicon/favicon-72.png'>
	<link rel='apple-touch-icon-precomposed' sizes='60x60' href='https://elo7.dev/images/favicon/favicon-60.png'>
	<link rel='apple-touch-icon-precomposed' sizes='57x57' href='https://elo7.dev/images/favicon/favicon-57.png'>
	<link rel='apple-touch-icon-precomposed' href='https://elo7.dev/images/favicon/favicon-precomposed.png'>
	<script>window.addEventListener('error', window.__e=function f(e){f.q=f.q||[];f.q.push(e)});</script>
	<script src='/js/vendor/async-define.js'></script>
</head>

    <body>
        <header class='left-pane'>
    <div class='logo-container'>
        <a rel='home' itemprop='url' href='https://elo7.dev/' class='logo'>Tech Blog Elo7</a>
    </div>
    <div class='navigation'>
        <input id='categories-switch' type='checkbox' class='categories-switch'>
        <label for='categories-switch' class='selectable'>
            <h2 class='nav-title'>Categorias</h2>
        </label>
        <nav aria-label='Navegue pelas categorias do nosso blog' class='nav-list nav-category'>
            
                <a href='/categoria/back-end' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Back End</a></span>
                </a>
            
                <a href='/categoria/big-data' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Big Data</a></span>
                </a>
            
                <a href='/categoria/cultura' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Cultura</a></span>
                </a>
            
                <a href='/categoria/design' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Design</a></span>
                </a>
            
                <a href='/categoria/devops' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Devops</a></span>
                </a>
            
                <a href='/categoria/eventos' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Eventos</a></span>
                </a>
            
                <a href='/categoria/front-end' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Front End</a></span>
                </a>
            
                <a href='/categoria/machine-learning' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Machine Learning</a></span>
                </a>
            
                <a href='/categoria/mobile' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Mobile</a></span>
                </a>
            
                <a href='/categoria/vagas' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                    <span itemprop='name'>Vagas</a></span>
                </a>
            
            <a href='/talks' itemscope itemtype='http://schema.org/SiteNavigationElement'>
                <span itemprop='name'>Palestras</span>
            </a>
        </nav>
    </div>
    <div class='navigation'>
        <input id='more-switch' type='checkbox' class='more-switch'>
        <label for='more-switch' class='selectable'>
            <h2 class='nav-title'>Veja também</h2>
        </label>
        <nav class='nav-list nav-more' aria-label='Navegue pelos links relacionados ao Elo7'>
            <a itemprop='relatedLink' href='/meetups'>
                <span itemprop='name'>Meetups no Elo7</span>
            </a>
            <a itemprop='relatedLink' href='http://carreira.elo7.com.br/engenharia/' target='_blank'>
                <span itemprop='name'>A engenharia</span>
            </a>
            <a itemprop='relatedLink' href='http://carreira.elo7.com.br/' target='_blank'>
                <span itemprop='name'>Carreiras</span>
            </a>
            <a itemprop='relatedLink' href='http://elo7.com.br/' target='_blank'>
                <span itemprop='name'>Elo7</span>
            </a>
        </nav>
    </div>
    <div class='social'>
        <a title='Github do Elo7' rel='external' itemprop='relatedLink' href='https://github.com/elo7' target='_blank' class='github'>Github do Elo7</a>
        <a title='Twitter do Elo7' rel='external' itemprop='relatedLink' href='https://twitter.com/elo7tech' target='_blank' class='twitter'>Twitter do Elo7</a>
        <a title='RSS do Elo7' rel='external' itemprop='relatedLink' href='https://elo7.dev/index.xml' target='_blank' class='rss'>RSS do Elo7</a>
        <a title='Newsletter do Elo7' rel='external' itemprop='relatedLink' href='http://eepurl.com/cVUwvH' target='_blank' class='email'>Newsletter do Elo7</a>
    </div>
</header>

        <main aria-label='Conteúdo principal' itemscope itemtype='http://schema.org/Blog'>
            <article itemprop='blogPost' itemscope itemtype='http://schema.org/BlogPosting' class='post-main'>
                <figure class='cover-image' itemprop="image" itemscope itemtype="http://schema.org/ImageObject">
                    <img src='/images/cover/elo7.png' alt='Elo7 &#43; Analytics = Elytics' itemprop="url">
                </figure>
                <div class='post-content'>
                    <h1 itemprop='name' class='title'>Elo7 &#43; Analytics = Elytics</h1>
                    <div class='post-meta'>
                        <p class='date'>
                            Publicado em:
                            <time class='date'
    datetime='2017-03-06 00:00:00 &#43;0000 UTC'
    aria-label='06 de março de 2017'>
    06/03/2017
    <meta itemprop='datePublished' content='Mon Mar 06 2017 00:00:00 GMT&#43;0000 (UTC)'/>
    <meta itemprop='dateModified' content='Mon Mar 06 2017 00:00:00 GMT&#43;0000 (UTC)'>
    <meta name='date' content='2017-03-06'>
</time>

                        </p>

                        <article>
                            
                                <a data-author='mikedias' itemprop='author' itemscope itemtype='http://schema.org/Person' rel='author' href='/autor/mikedias/' class='author'>
                                    <meta name='author' itemprop='url' content='/autor/mikedias'>
                                    <img class='hide avatar' width='50px' height='50px' itemprop='image'>
                                    <p itemprop='name' class='publisher' data-author='mikedias'>@mikedias</p>
                                </a>
                            

                            <meta itemprop='worksFor' content='Elo7 Serviços de Informática SA'>
                        </article>
                    </div>
                    <div itemprop='articleBody'>
                        

<p>Métricas, métricas, métricas! Aqui no <strong>Elo7</strong>, tanto as métricas de sistema (cpu, mémoria, disco, logs, etc) quanto as métricas de negócio (pedidos, carrinhos, mensagens) importam bastante. Tudo o que acontece no site é capturado, metrificado e monitorado em tempo real para que nós possamos saber se estamos indo bem ou mal e para onde devemos seguir. Para que isso seja possível nós criamos o <strong>Elytics (Elo7 + Analytics)</strong>.</p>

<h2 id="o-que-é-o-elytics">O que é o Elytics?</h2>

<p>O Elytics é um conjunto de ferramentas combinadas com o propósito de fornecer uma solução completa para a análise de dados e tomada de decisão em tempo real.</p>

<p>Uma definição mais épica pode ser: um conceito que transcende o ferramental, remetendo a tudo o que está relacionado à metrificação. É comum ouvir as pessoas dizendo &ldquo;enviar para o Elytics&rdquo; ou &ldquo;visualizar no Elytics&rdquo; quando na verdade estão enviando para o Kafka e visualizando no Kibana.</p>

<p>No Elytics, o fluxo de dados é dividido em quatro etapas, cada uma delas com um componente chave: <strong>Coleta (Kafka), Processamento (Flink), Armazenamento (Elasticsearch) e Visualização (Kibana)</strong></p>

<h2 id="coleta-kafka">Coleta: Kafka</h2>

<p>A porta de entrada do Elytics é o <a href="http://kafka.apache.org/">Apache Kafka</a>.
Tudo o que acontece em nossos sistemas gera um evento que é enviado para um tópico do Kafka, ficando imediatamente disponível para ser consumido por outros sistemas.</p>

<p>Uma vez enviado para o Kafka, o histórico e a auditoria de cada evento está garantido, pois temos uma instância do <a href="https://github.com/pinterest/secor">Secor</a> que faz o backup dos dados para o <a href="https://aws.amazon.com/pt/s3/">Amazon S3</a>.</p>

<h2 id="processamento-flink">Processamento: Flink</h2>

<p>O dado que chega no Kafka ainda é um dado bruto que precisa ser lapidado antes de podermos analisá-lo. Para que isso possa ser feito em tempo real, escolhemos o <a href="http://flink.apache.org/">Apache Flink</a> por sua natureza streaming e sua simplicidade.</p>

<p>Os streams Flink consomem os dados do Kafka para transformar, filtrar, agregar e enriquecer o dado, deixando-o pronto para ser analisado.</p>

<p>Para simplificar nossa vida, nosso cluster roda no <a href="https://aws.amazon.com/pt/emr/">Amazon EMR</a>, que nos ajuda providenciando as máquinas, o <a href="http://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html">Hadoop Distributed File System (HDFS)</a> e o <a href="http://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/YARN.html">Hadoop YARN</a>.</p>

<h2 id="armazenamento-elasticsearch">Armazenamento: Elasticsearch</h2>

<p>Com o dado pronto para ser analisado, o stream do Flink armazena o dado em índices no <a href="https://www.elastic.co/products/elasticsearch">Elasticsearch</a>. Apesar do que o nome possa sugerir, o Elasticsearch não é apenas um motor de busca, é também um sistema distribuído de alta performance com capacidades analíticas avançadas.</p>

<p>Quando o dado está no Elasticsearch, já conseguimos extrair métricas através do <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html">Framework de Agregações</a>. Aqui começa a diversão: dá pra fazer histogramas, agrupamentos por limites geográficos (!), somatórias, médias móveis, percentil e etc. Tudo isso em tempo real.</p>

<p>Um fato interessante sobre essa arquitetura é que os dados que estão armazenados nos índices do Elasticsearch podem ser apagados e reconstruídos a qualquer momento. Para isso, basta processar os eventos históricos que foram previamente armazenados no S3 e, graças a API unificada do Flink, conseguimos fazer isso com <em>exatamente</em> o mesmo código que consome os dados do Kafka.</p>

<h2 id="visualização-kibana">Visualização: Kibana</h2>

<p>Nós já conseguimos metrificar os dados através do Elasticsearch, mas é no <a href="https://www.elastic.co/products/kibana">Kibana</a> que vemos os gráficos cheios de vida. O Kibana funciona como uma janela para nossos dados. Nele, conseguimos criar uma análise em poucos segundos e podemos agrupar estas análises em dashboards interativos como este aqui:</p>

<p><img src="../images/elo7-analytics-elytics-1.jpg" alt="&quot;Kibana Dashboard&quot;" /></p>

<p>Como nem tudo o que tem no Elasticsearch tem no Kibana, eles criaram um sistema de plugins onde você mesmo pode criar suas próprias análises customizadas no Kibana. Nós aqui do Elo7 gostamos muito de <a href="https://en.wikipedia.org/wiki/Cohort_analysis">análises de Cohort</a>, então criamos o <a href="https://github.com/elo7/cohort">nosso próprio plugin para análise de Cohort</a>.</p>

<h2 id="conclusão">Conclusão</h2>

<p>Bom, esse é o Elytics! Estamos preparando algumas novidades para melhorá-lo ainda mais e que darão um ótimo tema para um próximo post!</p>


                        <ul class='tag-list'>
                            
                                <li>
                                    <a href='/tags/analytics/'>analytics</a>
                                </li>
                            
                                <li>
                                    <a href='/tags/kafka/'>kafka</a>
                                </li>
                            
                                <li>
                                    <a href='/tags/flink/'>flink</a>
                                </li>
                            
                                <li>
                                    <a href='/tags/elasticsearch/'>elasticsearch</a>
                                </li>
                            
                                <li>
                                    <a href='/tags/kibana/'>kibana</a>
                                </li>
                            
                        </ul>
                        <section class='share'>
                            <a href='#share' class='share-post hide' title='Clique aqui para compartilhar esse post'>Compartilhe</a>
                            <div class='social-share'>
                                <a href='https://www.facebook.com/dialog/share?app_id=644444999041914&href=https%3a%2f%2felo7.dev%2felo7-analytics-elytics%2f&display=popup' rel='noopener' target='_blank' class='link-share facebook' title='Clique para compartilhar no Facebook'>
                                    Compartilhar no facebook
                                </a>
                                <a href='https://twitter.com/intent/tweet?text=elo7-%2b-analytics-elytics&url=https%3a%2f%2felo7.dev%2felo7-analytics-elytics%2f&hashtags=elo7tech' rel='noopener' target='_blank' class='link-share twitter' title='Clique para compartilhar no Twitter'>
                                    Compartilhar no twitter
                                </a>
                                <a href='https://elo7.dev/elo7-analytics-elytics/?utm_source=share&utm_medium=copy' class='link-share hide copy' title='Clique para copiar a url'>
                                    Copiar URL
                                </a>
                                <span class='copy-success'>Link copiado</span>
                                <input type='url' value='https://elo7.dev/elo7-analytics-elytics/?utm_source=share&utm_medium=copy' class='link-input'>
                            </div>
                        </section>
                    </div>
                    <meta itemprop='headline' content='Métricas, métricas, métricas! Aqui no Elo7, tanto as métricas de sistema (cpu, mémoria, disco, logs, etc) quanto as métricas de negócio (pedidos, carrinhos, mensagens) importam bastante. Tudo o que acontece no site é capturado, metrificado e monitorado em tempo real para que nós possamos saber se estamos indo bem ou mal e para onde devemos seguir. Para que isso seja possível nós criamos o Elytics (Elo7 &#43; Analytics).'/>
                    <span itemprop='publisher' itemscope itemtype='http://schema.org/Organization'>
                        <meta itemprop='name' content='Elo7 Tech'/>
                        <meta itemprop='url' content='https://elo7.dev/'/>
                        <span itemprop='logo' itemscope itemtype='http://schema.org/ImageObject'>
                            <link href='https://images.elo7.com.br/assets/v3/desktop/png/logo-elo7.png' itemprop='url'/>
                            <meta itemprop='width' content='100px'/>
                            <meta itemprop='height' content='100px'/>
                        </span>
                    </span>
                    <meta itemprop='mainEntityOfPage' content='Elo7 Serviços de Informática SA'/>

                    <div id='disqus_thread'></div>
                </div>
            </article>
        </main>

        <footer itemscope itemtype='http://schema.org/Organization'>
    <a rel='home' itemprop='url' href='https://elo7.dev/' >
        elo7.dev © <script>now = new Date; document.write(now.getFullYear());</script>
    </a>
    <meta itemprop='name' content='Elo7 Serviços de Informática SA'/>
    <section class='footer-social'>
        <a title='Github do Elo7' rel='external' itemprop='url' href='https://github.com/elo7' target='_blank' class='github'>Github do Elo7</a>
        <a title='Twitter do Elo7' rel='external' itemprop='url' href='https://twitter.com/elo7tech' target='_blank' class='twitter'>Twitter do Elo7</a>
        <a title='RSS do Elo7' rel='external' itemprop='url' href='https://elo7.dev/index.xml' target='_blank' class='rss'>RSS do Elo7</a>
        <a title='Newsletter do Elo7' rel='external' itemprop='url' href='http://eepurl.com/cVUwvH' target='_blank' class='email'>Newsletter do Elo7</a>
    </section>
</footer>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script async src='/js/analytics.js'></script>
<script async src='/js/github.js'></script>
<script async src='/js/vendor/events-amd.js'></script>
<script async src='/js/vendor/ajax.js'></script>
<script async src='/js/vendor/doc.js'></script>
<script type='text/x-mathjax-config'>
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ],
            displayMath: [ ['$$','$$'], ['\[','\]'] ],
            processEscapes: true
        },
    });
</script>
<script async src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
<script src='/js/vendor/highlight.js'></script>
<script>hljs.initHighlightingOnLoad();</script>


        <script>
            var disqus_shortname = 'engenhariaelo7';
            var disqus_identifier = '2017-03-06 00:00:00 \x2b0000 UTC:\/elo7-analytics-elytics\/';
            var disqus_url = 'https:\/\/elo7.dev\/elo7-analytics-elytics\/';

            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Habilite o JavaScript para ver os comentários</noscript>
        <script async src='/js/post.js'></script>
    </body>
</html>
